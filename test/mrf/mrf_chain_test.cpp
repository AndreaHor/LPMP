#ifndef LPMP_MRF_CHAIN_TEST_CPP
#define LPMP_MRF_CHAIN_TEST_CPP

#include <string>
#include <vector>
#include "mrf/graphical_model.h"
#include "visitors/standard_visitor.hxx"
#include "mrf/mrf_uai_input.h"
#include "test.h"


const std::string uai_chain = 
R"(MARKOV
41
9 7 6 7 6 6 6 5 7 7 6 5 5 5 5 5 5 5 5 5 1 5 5 5 5 5 5 5 5 4 5 5 6 6 7 8 8 8 8 11 11 
81
1 0 
1 1 
1 2 
1 3 
1 4 
1 5 
1 6 
1 7 
1 8 
1 9 
1 10 
1 11 
1 12 
1 13 
1 14 
1 15 
1 16 
1 17 
1 18 
1 19 
1 20 
1 21 
1 22 
1 23 
1 24 
1 25 
1 26 
1 27 
1 28 
1 29 
1 30 
1 31 
1 32 
1 33 
1 34 
1 35 
1 36 
1 37 
1 38 
1 39 
1 40 
2 0 1 
2 1 2 
2 2 3 
2 3 4 
2 4 5 
2 5 6 
2 6 7 
2 7 8 
2 8 9 
2 9 10 
2 10 11 
2 11 12 
2 12 13 
2 13 14 
2 14 15 
2 15 16 
2 16 17 
2 17 18 
2 18 19 
2 19 20 
2 20 21 
2 21 22 
2 22 23 
2 23 24 
2 24 25 
2 25 26 
2 26 27 
2 27 28 
2 28 29 
2 29 30 
2 30 31 
2 31 32 
2 32 33 
2 33 34 
2 34 35 
2 35 36 
2 36 37 
2 37 38 
2 38 39 
2 39 40 

9
0.302861 0.302553 0.378761 0.178255 0.015477 0.015421 0.015308 0.072502 0.482121 

7
0.319889 0.340008 0.024224 0.023436 0.023701 0.073522 0.461183 

6
0.352998 0.018909 0.018049 0.018499 0.112109 0.476374 

7
0.319164 0.093817 0.016931 0.016300 0.016733 0.181381 0.435414 

6
0.292285 0.030099 0.029438 0.030885 0.049530 0.409113 

6
0.252221 0.009586 0.009655 0.011891 0.119710 0.385832 

6
0.054543 0.026428 0.027533 0.029436 0.236457 0.403771 

5
0.011282 0.010549 0.015812 0.083643 0.381462 

7
0.376192 0.109589 0.003924 0.003266 0.007191 0.133671 0.397739 

7
0.411292 0.074722 0.007194 0.006373 0.008488 0.171625 0.433364 

6
0.059278 0.011704 0.010791 0.011785 0.193856 0.469956 

5
0.060101 0.011079 0.010080 0.010888 0.190360 

5
0.067497 0.008033 0.007357 0.007857 0.172642 

5
0.079522 0.005548 0.005146 0.005543 0.153559 

5
0.084911 0.004638 0.003834 0.004266 0.145654 

5
0.095583 0.003197 0.002102 0.002726 0.136393 

5
0.113236 0.003011 0.001788 0.002480 0.121340 

5
0.118041 0.004735 0.003491 0.004228 0.122928 

5
0.110184 0.004940 0.003673 0.004658 0.132038 

5
0.110114 0.002201 0.000970 0.002588 0.123999 

1
-0.000000 

5
0.128186 0.001866 0.001202 0.002443 0.096423 

5
0.136165 0.003680 0.003810 0.004371 0.088714 

5
0.135739 0.007143 0.007713 0.008201 0.088462 

5
0.108145 0.007912 0.007422 0.008158 0.113681 

5
0.084263 0.009630 0.008642 0.009541 0.142513 

5
0.062263 0.017616 0.016309 0.017200 0.179926 

5
0.047906 0.028465 0.026829 0.027878 0.213114 

5
0.030125 0.031843 0.032436 0.046791 0.266226 

4
0.021255 0.022392 0.023080 0.058633 

5
0.014449 0.014693 0.015741 0.063676 0.376940 

5
0.012100 0.012924 0.013575 0.066760 0.394147 

6
0.148186 0.007476 0.008550 0.008718 0.084079 0.402034 

6
0.121147 0.004253 0.004639 0.004901 0.102338 0.382751 

7
0.082103 0.006121 0.005790 0.006383 0.142874 0.466150 0.361048 

8
0.050650 0.015350 0.014758 0.014984 0.196338 0.459154 0.375875 0.326675 

8
0.029169 0.029265 0.030127 0.030221 0.254163 0.446208 0.390247 0.351987 

8
0.016053 0.015751 0.017038 0.047595 0.482376 0.407202 0.348779 0.328131 

8
0.004624 0.004036 0.005797 0.083691 0.453265 0.395227 0.330644 0.318570 

11
0.453391 0.100216 0.003544 0.002872 0.004645 0.136978 0.444226 0.397277 0.336253 0.332984 0.377285 

11
0.444228 0.073670 0.008589 0.007761 0.009641 0.173215 0.427638 0.372445 0.313733 0.313565 0.357783 

63
0.010176 0.046434 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 
0.032378 0.015409 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 
0.106927 0.020179 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 
1000.000000 1000.000000 0.004777 0.120416 0.482251 282.752533 1000.000000 
1000.000000 1000.000000 0.005190 0.005708 0.124114 0.486325 1000.000000 
1000.000000 1000.000000 0.005309 0.005652 0.006551 0.124543 1000.000000 
1000.000000 1000.000000 0.139104 0.006114 0.005739 0.006266 1218438.250000 
1000.000000 1000.000000 0.530111 0.139171 0.006374 0.005717 34150.761719 
1000.000000 1000.000000 1000.000000 1000.000000 5718447.000000 218867.156250 0.002308 

42
0.058742 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 0.013456 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 0.004838 0.006233 0.196270 0.669676 1000.000000 1000.000000 0.005607 0.004982 0.006387 0.195206 3250855.500000 1000.000000 0.096678 0.006019 0.005000 0.005564 81016.960938 1000.000000 0.472233 0.095869 0.005516 0.004980 5375.624023 1000.000000 1000.000000 1000.000000 1000.000000 4200152.000000 0.017590 

42
0.014950 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 0.012745 0.012755 0.015264 0.234957 0.740636 1000.000000 1000.000000 0.072069 0.014472 0.012800 0.015025 0.232701 41202860.000000 1000.000000 0.410164 0.072693 0.014679 0.012726 0.013381 998959.250000 1000.000000 737.010559 0.409269 0.071618 0.013653 0.012478 43626.242188 1000.000000 1000.000000 1000.000000 1000.000000 47109240.000000 798340.625000 0.010538 

42
0.017635 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 0.021904 0.022960 0.257643 0.753826 1000.000000 1000.000000 0.022179 0.022086 0.025329 0.257952 1000.000000 1000.000000 0.049967 0.024780 0.021938 0.024570 1000.000000 1000.000000 0.339363 0.050295 0.025065 0.021781 39785784.000000 1000.000000 2969.516113 0.337537 0.049361 0.023985 652390.375000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 0.016614 

36
0.011263 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 0.018100 0.020787 0.241322 0.718371 1000.000000 1000.000000 0.019123 0.018369 0.022440 0.239504 1000.000000 1000.000000 0.051869 0.021701 0.018214 0.021062 1000.000000 1000.000000 0.335873 0.051052 0.021648 0.018159 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 0.014343 

36
1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 0.020395 0.020948 0.025722 0.252356 0.746955 1000.000000 0.046434 0.023663 0.020901 0.025538 0.247931 1000.000000 0.318779 0.047111 0.025440 0.020567 0.023635 1000.000000 63263.011719 0.315413 0.045742 0.024625 0.020459 57237640.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 0.038055 

30
0.020707 0.023330 0.246719 0.728545 1000.000000 0.022195 0.020907 0.026121 0.244396 1000.000000 0.049560 0.025626 0.020381 0.025102 1000.000000 0.318777 0.047226 0.025288 0.020112 1000.000000 252975.828125 0.310892 0.044446 0.025070 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 0.015880 

35
1000.000000 0.010256 0.008263 0.011125 0.191976 0.624569 1000.000000 1000.000000 0.069583 0.011087 0.008205 0.011893 0.187998 1000.000000 1000.000000 0.379686 0.074268 0.013484 0.008157 0.011312 1000.000000 1000.000000 509901.937500 0.380984 0.070875 0.012122 0.008114 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 0.006383 

49
0.003413 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 0.003615 0.005226 0.161673 0.571157 657902.000000 1000.000000 1000.000000 0.004793 0.003596 0.005511 0.163236 0.571468 1000.000000 1000.000000 0.084875 0.006180 0.003659 0.005717 0.160437 1000.000000 1000.000000 0.414565 0.088393 0.007396 0.003865 0.005764 1000.000000 1000.000000 772399.750000 0.415593 0.086273 0.006658 0.003947 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 0.003217 

42
1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 0.001031 0.002152 0.139734 0.526919 891629.687500 1000.000000 0.002143 0.001042 0.002243 0.140245 0.526531 1000.000000 0.099453 0.002725 0.001100 0.002137 0.138723 1000.000000 0.441496 0.100894 0.003127 0.001245 0.002387 1000.000000 911516.875000 0.441468 0.099673 0.003138 0.001346 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 0.001346 

30
0.000193 0.001332 0.115871 0.472180 939954.375000 0.001136 0.000211 0.001004 0.115994 0.471856 0.119496 0.001443 0.000253 0.000851 0.115204 0.485001 0.120298 0.001285 0.000258 0.000999 1037344.625000 0.484808 0.119023 0.001135 0.000236 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 

25
0.000598 0.001980 0.104470 0.442682 760263.000000 0.001054 0.000697 0.001128 0.104494 0.442685 0.127284 0.001559 0.000920 0.001063 0.104126 0.501569 0.129337 0.001685 0.000987 0.001287 991095.750000 0.503117 0.128694 0.001442 0.000979 

25
0.000635 0.001996 0.098613 0.429214 538088.875000 0.001509 0.000675 0.001031 0.099247 0.429793 0.128528 0.001112 0.000726 0.000968 0.098923 0.497812 0.130174 0.001217 0.000744 0.000891 826796.187500 0.499286 0.129938 0.001002 0.000759 

25
0.000231 0.001360 0.105562 0.446692 452257.531250 0.001656 0.000213 0.000593 0.107001 0.447551 0.118160 0.000776 0.000210 0.000632 0.106465 0.469345 0.119201 0.000603 0.000215 0.000289 571870.437500 0.470102 0.118678 0.000373 0.000202 

25
0.000453 0.001518 0.102411 0.443716 434266.562500 0.001883 0.000475 0.001236 0.104441 0.445051 0.124406 0.001112 0.000545 0.001169 0.103661 0.484151 0.125424 0.000953 0.000597 0.000769 473746.500000 0.484420 0.124558 0.000709 0.000600 

25
0.000787 0.001944 0.099754 0.440906 491737.531250 0.002166 0.000769 0.001583 0.101461 0.442261 0.134209 0.001656 0.000768 0.001438 0.100676 0.514993 0.135733 0.001405 0.000771 0.001018 482169.250000 0.515851 0.134629 0.000897 0.000771 

25
0.000645 0.002106 0.117696 0.481732 502910.468750 0.002028 0.000646 0.001567 0.119457 0.483792 0.121806 0.001589 0.000648 0.001400 0.118837 0.498817 0.123573 0.001470 0.000640 0.000894 480083.218750 0.500257 0.122639 0.000860 0.000592 

25
0.000179 0.001553 0.130042 0.518467 492095.062500 0.001546 0.000180 0.001253 0.132406 0.521293 0.113239 0.001072 0.000196 0.001332 0.131797 0.482008 0.115034 0.001090 0.000225 0.000714 435162.250000 0.484080 0.114412 0.000574 0.000239 

25
0.000880 0.002426 0.115862 0.489442 447533.187500 0.002003 0.000892 0.002162 0.118983 0.492973 0.124398 0.001840 0.000924 0.002709 0.118208 0.497095 0.127149 0.002108 0.001029 0.001926 409400.000000 0.500267 0.126417 0.001526 0.001088 

5
0.110114 0.002201 0.000970 0.002588 0.123999 

5
0.128186 0.001866 0.001202 0.002443 0.096423 

25
0.000693 0.004688 0.101373 0.422163 286268.968750 0.003609 0.000787 0.001183 0.103020 0.425968 0.115775 0.001181 0.001039 0.001512 0.103244 0.468665 0.120884 0.002219 0.001265 0.001981 265767.937500 0.476167 0.122194 0.002449 0.001304 

25
0.001108 0.006595 0.106488 0.423452 234210.234375 0.005387 0.001182 0.001764 0.107684 0.427574 0.105210 0.001762 0.001232 0.001646 0.108304 0.435876 0.108685 0.001762 0.001240 0.001936 195701.031250 0.441726 0.109750 0.001965 0.001233 

25
0.002037 0.006664 0.129890 0.472161 199650.984375 0.007942 0.002082 0.002633 0.133816 0.478333 0.077561 0.003143 0.002181 0.002879 0.134759 0.363754 0.079123 0.002685 0.002239 0.002974 132031.796875 0.368163 0.079225 0.002923 0.002193 

25
0.001557 0.004610 0.128783 0.472931 156687.359375 0.006292 0.001772 0.002627 0.133697 0.478105 0.077146 0.002500 0.001929 0.002843 0.133294 0.362162 0.079019 0.002493 0.001919 0.002626 106605.906250 0.365685 0.078640 0.002806 0.001871 

25
0.002089 0.004215 0.133429 0.480851 127979.796875 0.005268 0.002204 0.003092 0.137244 0.483466 0.076410 0.003060 0.002254 0.003054 0.135727 0.364153 0.078521 0.002938 0.002239 0.002877 97499.734375 0.366200 0.077470 0.003330 0.002170 

25
0.001648 0.003494 0.128790 0.471344 113895.546875 0.003663 0.001665 0.002761 0.131901 0.472002 0.082077 0.002914 0.001663 0.002516 0.129651 0.378140 0.084413 0.002445 0.001660 0.002665 103535.296875 0.378525 0.082280 0.002982 0.001607 

25
0.003053 0.004461 0.141590 0.498030 123085.093750 0.004355 0.003020 0.004422 0.144915 0.498603 0.073447 0.004180 0.003017 0.004374 0.142591 0.360880 0.076123 0.003933 0.003059 0.005480 115686.125000 0.360682 0.073573 0.004571 0.003291 

20
0.001045 0.001918 0.127399 0.476274 0.002213 0.001075 0.002320 0.130605 0.086454 0.002085 0.001068 0.002669 0.390032 0.089021 0.002280 0.001044 144893.328125 0.390311 0.087442 0.003876 

20
0.000863 0.001367 0.120535 0.467835 1000.000000 0.001628 0.001008 0.002337 0.123194 1000.000000 0.095749 0.001654 0.000988 0.002561 1000.000000 0.407817 0.097503 0.002392 0.000919 1000.000000 

25
0.000439 0.000915 0.113825 0.451127 1000.000000 0.000600 0.000424 0.001071 0.114927 1000.000000 0.102830 0.001132 0.000383 0.001620 1000.000000 0.428028 0.105168 0.001980 0.000385 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 0.000830 

30
0.007056 0.001355 0.001681 0.129970 0.483833 1000.000000 0.088008 0.001517 0.001297 0.001439 0.130920 1000.000000 0.394319 0.089905 0.001653 0.001328 0.002166 1000.000000 158973.578125 0.400795 0.091955 0.002628 0.001360 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 0.001716 

36
0.001488 0.004930 0.131411 0.488812 184295.125000 1000.000000 0.006027 0.001504 0.001563 0.133998 0.494106 1000.000000 0.085997 0.001793 0.001583 0.001886 0.135564 1000.000000 0.387402 0.086693 0.001697 0.001619 0.002695 1000.000000 157917.890625 0.391013 0.087605 0.002599 0.001583 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 0.001963 

42
0.003875 0.006404 0.148748 0.519315 194798.375000 1000.000000 1000.000000 0.007481 0.003952 0.004029 0.152683 0.525482 1000.000000 1000.000000 0.069184 0.004027 0.004159 0.004945 0.153920 1000.000000 1000.000000 0.349023 0.070389 0.004477 0.004252 0.005716 1000.000000 1000.000000 147465.109375 0.352656 0.071093 0.005765 0.004181 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 0.056748 0.004784 

56
0.003862 0.004791 0.150823 0.524363 195158.125000 1000.000000 1000.000000 1000.000000 0.006153 0.004297 0.004626 0.154568 0.528322 1000.000000 1000.000000 1000.000000 0.068341 0.004352 0.004400 0.005028 0.154429 1000.000000 1000.000000 1000.000000 0.347777 0.069788 0.005257 0.004386 0.005587 1000.000000 1000.000000 1000.000000 153455.171875 0.350259 0.070169 0.006471 0.004454 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 0.003876 0.108748 0.289210 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 0.060795 0.005874 0.103304 

64
0.003220 0.003410 0.149488 0.526457 205530.359375 1000.000000 1000.000000 1000.000000 0.003917 0.003635 0.004393 0.151711 0.528099 1000.000000 1000.000000 1000.000000 0.074322 0.003958 0.003723 0.004377 0.151114 1000.000000 1000.000000 1000.000000 0.363135 0.074807 0.004452 0.003711 0.004947 1000.000000 1000.000000 1000.000000 181009.421875 0.362995 0.074592 0.005470 0.003715 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 0.003752 0.116133 0.305539 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 0.069533 0.005965 0.090832 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 0.201799 0.075706 0.007265 

64
0.002104 0.002238 0.143536 0.515600 1000.000000 1000.000000 1000.000000 1000.000000 0.002171 0.002180 0.003362 0.144510 1000.000000 1000.000000 1000.000000 1000.000000 0.083659 0.002950 0.002217 0.003358 1000.000000 1000.000000 1000.000000 1000.000000 0.391726 0.083645 0.002851 0.002263 1000.000000 1000.000000 1000.000000 1000.000000 242488.281250 0.390615 0.082880 0.003604 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 0.060851 0.003203 0.116520 0.301350 1000.000000 1000.000000 1000.000000 1000.000000 0.145155 0.081084 0.005090 0.073721 1000.000000 1000.000000 1000.000000 1000.000000 0.515172 0.209216 0.058642 0.005399 

64
0.005179 0.005518 0.167408 0.565327 1000.000000 1000.000000 1000.000000 1000.000000 0.005230 0.005304 0.006942 0.167794 1000.000000 1000.000000 1000.000000 1000.000000 0.073862 0.006487 0.005313 0.006571 1000.000000 1000.000000 1000.000000 1000.000000 0.377418 0.073694 0.006364 0.005290 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 0.004914 0.074434 0.251990 0.757252 1000.000000 1000.000000 1000.000000 1000.000000 0.051994 0.005552 0.119257 0.320707 1000.000000 1000.000000 1000.000000 1000.000000 0.155078 0.076019 0.008888 0.061298 1000.000000 1000.000000 1000.000000 1000.000000 0.510157 0.195761 0.042466 0.008227 

88
1000.000000 0.008549 0.006591 0.007313 0.181524 0.600763 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 0.068529 0.006922 0.006668 0.008317 0.180757 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 0.373799 0.071474 0.008305 0.006625 0.007625 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 292445.906250 0.377636 0.070842 0.007884 0.006601 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 0.005340 0.091349 0.291506 0.790072 21992.457031 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 0.053386 0.006589 0.124797 0.321929 0.614613 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 0.179093 0.084924 0.010779 0.042398 0.154168 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 0.535060 0.187304 0.024232 0.008207 0.012892 

121
0.001804 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 0.002293 0.002846 0.152950 0.553800 373421.312500 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 0.003227 0.002324 0.003072 0.156478 0.557618 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 0.088328 0.003174 0.002269 0.003959 0.155342 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 0.422097 0.091143 0.003949 0.002247 0.003597 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 282844.843750 0.424641 0.089939 0.003354 0.002244 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 0.001849 0.105868 0.286831 0.726468 13417.084961 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 0.073354 0.002641 0.116185 0.271769 0.517639 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 0.216877 0.107240 0.004038 0.018857 0.101459 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 0.593035 0.195747 0.009757 0.002711 0.026828 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 1000.000000 17007.210938 0.410274 0.054653 0.037250 0.001975 
)";

using namespace LPMP;

int main(int argc, char** argv)
{
   std::vector<std::string> options = {
      {""},
      {"--maxIter"}, {"2"},
      {"--roundingReparametrization"}, {"anisotropic"},
      {"--standardReparametrization"}, {"anisotropic"}
   };

   MpRoundingSolver<Solver<LP<FMC_SRMP>,StandardVisitor>> solver(options);
   auto input = mrf_uai_input::parse_string(uai_chain);
   solver.template GetProblemConstructor<0>().construct(input);
   solver.Solve();

   test(std::abs(solver.lower_bound() - 0.629357) < 1e-5);
   test(std::abs(solver.primal_cost() - 0.629357) < 1e-5);
}

#endif // LPMP_MRF_CHAIN_TEST_CPP
